# Smidr Build Configuration
# Generated by 'smidr init yggdrasil'

name: yggdrasil
description: "Custom embedded Linux image"

# Base system configuration
base:
  provider: toradex
  machine: verdin-imx8mp
  distro: tdx-xwayland
  version: "6.0.0"

# Layer configuration
layers:
  # BSP layers (automatically managed)
  - name: meta-toradex-bsp-common
    git: https://git.toradex.com/meta-toradex-bsp-common.git
    branch: kirkstone-6.x.y

  # Custom layers (your application code)
  # - name: meta-mycompany
  #   path: ./layers/meta-mycompany
  #
  # - name: meta-myapp
  #   git: https://github.com/mycompany/meta-myapp
  #   branch: main

# Build configuration
build:
  image: core-image-weston
  machine: verdin-imx8mp

  # Extra packages to include
  extra_packages:
    - python3
    - nodejs
    - vim

  # Build options
  parallel_make: 8
  bb_number_threads: 8

# Output artifacts to extract
artifacts:
  - "*.wic"           # Disk images
  - "*.tar.bz2"       # Root filesystem archives
  - "*-sdk-*.sh"      # SDK installers

# Container configuration
container:
  # Base image for builds (will be created automatically)
  base_image: "smidr/yocto-builder:kirkstone"

  # Resource limits
  memory: "8g"
  cpu_count: 8

# Cache configuration
cache:
  # Shared cache locations
  downloads: ~/.smidr/downloads
  sstate: ~/.smidr/sstate-cache

  # Cache retention (days)
  retention: 30
